from matplotlib import pyplot as plt
from tqdm import tqdm
import cv2
import numpy as np
import os
import tensorflow as tf
import keras
from keras import layers
from keras.optimizers import schedules
import datetime

#----Custom data generator----------
from datagenerator import DataGenerator

print("number of GPU detected: ", len(tf.config.list_physical_devices('GPU')))
    
def visualize_results(history):
  figure = plt.figure(figsize=(15, 10))
  plt.subplot(211)
  plt.title('Cross Entropy Loss')
  plt.plot(history.history['loss'], color='blue', label='train')
  plt.plot(history.history['val_loss'], color='orange', label='test')
  # plot accuracy
  plt.subplot(212)
  plt.title('Classification Accuracy')
  plt.plot(history.history['acc'], color='blue', label='train')
  plt.plot(history.history['val_acc'], color='orange', label='test')

## 3D VGG16 implementation

def get_model_3DVGG(shape = (256, 256, 256, 1)):

  model = tf.keras.models.Sequential([
      # BLOCK-1
          tf.keras.layers.Conv3D(32,(3,3,3), activation = 'relu', input_shape=(shape), padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.SpatialDropout3D(0.2),
          tf.keras.layers.Conv3D(32,(3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.SpatialDropout3D(0.2),
          tf.keras.layers.MaxPool3D((2,2,2)),
          #tf.keras.layers.Dropout(0.2),
      # BLOCK-2
          tf.keras.layers.Conv3D(64, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.2),
          tf.keras.layers.Conv3D(64, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.2),
          tf.keras.layers.MaxPool3D((2,2,2)), 
          #tf.keras.layers.Dropout(0.3),
      # BLOCK-3    
          tf.keras.layers.Conv3D(128, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(), 
          tf.keras.layers.Dropout(0.3),
          tf.keras.layers.Conv3D(128, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.MaxPool3D((2,2,2)),
          tf.keras.layers.Dropout(0.2),
      # BLOCK-4
          tf.keras.layers.Conv3D(256, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.3),
          tf.keras.layers.Conv3D(256, (3,3,3), activation = 'relu', padding = 'same'),
          tf.keras.layers.BatchNormalization(),
          #tf.keras.layers.MaxPool3D((2,2,2)),
          tf.keras.layers.Dropout(0.2),
      # End BLOCK-(FC Dense with BN and Activation = RELU)
          tf.keras.layers.Flatten(),
          tf.keras.layers.Dense(512, activation = 'relu'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.2),
          tf.keras.layers.Dense(256, activation = 'relu'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.2),
          tf.keras.layers.Dense(128, activation = 'relu'),
          tf.keras.layers.BatchNormalization(),
          tf.keras.layers.Dropout(0.2),
          tf.keras.layers.Dense(1, activation='sigmoid')
  ])

  model.compile(optimizer = 'adam', loss='binary_crossentropy', metrics = ['acc'])

  return model

params = {'dim': (256,256,256),
          'batch_size': 4,
          'n_classes': 2,
          'n_channels': 1,
          'shuffle': True}

partition = {'train': ['1002', '10032', '10064', '10072', '1008', '10085', '1011', '10126', '10131', '10134', '10164', '10169', '10221', '10225', '10239', '10248', '10254', '10261', '10276', '10282', '10285', '10288', '10338', '10341', '10351', '10364', '10383', '10388', '10389', '10418', '10429', '10471', '1048', '10486', '1049', '10516', '10522', '10529', '10531', '10571', '10577', '1058', '10583', '10591', '10593', '10595', '10616', '10620', '1063', '1065', '10650', '10653', '10657', '1068', '10707', '1094', '1099', '1103', '1111', '1115', '1128', '114', '1142', '1148', '1153', '1162', '117', '1172', '1173', '1175', '1187', '1189', '1195', '120', '1202', '1219', '1231', '1234', '1242', '1248', '1249', '1256', '128', '1288', '1335', '1357', '1363', '1364', '1399', '1417', '1426', '1431', '1435', '1467', '1471', '1480', '1490', '1500', '1504', '1519', '1553', '1560', '1573', '1575', '1583', '1595', '1598', '1606', '1612', '1621', '1634', '1639', '1641', '1659', '1660', '1667', '1674', '1683', '1700', '1709', '1766', '1788', '1790', '1807', '1809', '1816', '1825', '1827', '183', '1836', '1838', '1865', '1868', '1874', '1891', '1892', '1894', '191', '1912', '1929', '1940', '1943', '1944', '1945', '1952', '1958', '198', '1980', '1989', '2010', '2011', '2036', '2039', '204', '2063', '2066', '2071', '2079', '2088', '2106', '2110', '2117', '2124', '2130', '2132', '2133', '214', '2144', '2157', '2173', '2178', '2181', '2185', '2203', '2221', '2229', '2232', '2248', '2249', '2259', '2269', '2272', '228', '2280', '2290', '2304', '2311', '2335', '2347', '2355', '2371', '2384', '2394', '2417', '2418', '2425', '2429', '2445', '2452', '2459', '2469', '2496', '2511', '2529', '2548', '2550', '2574', '2587', '2607', '263', '2632', '2638', '2641', '2651', '2674', '2677', '268', '2700', '2701', '2706', '271', '2740', '2756', '2761', '2765', '2802', '2850', '2907', '2908', '2922', '2932', '2934', '2937', '294', '2945', '2973', '2993', '2996', '3009', '3011', '3028', '3046', '305', '3053', '3056', '3061', '3077', '3084', '3090', '3091', '31', '3108', '3113', '3137', '3157', '3174', '3188', '3189', '3201', '3216', '3227', '3234', '3235', '3236', '3246', '3260', '3274', '3300', '3301', '3303', '3327', '337', '3375', '3376', '3386', '3395', '3418', '3434', '3448', '3450', '3490', '3507', '3510', '352', '3523', '3537', '3547', '3552', '3558', '3560', '3564', '3579', '3617', '362', '3627', '364', '3649', '3660', '3674', '3699', '3717', '3728', '3729', '3732', '3742', '375', '3758', '3759', '3768', '3775', '3788', '3817', '3819', '3826', '3841', '3858', '3862', '3876', '3890', '3925', '3970', '3971', '3978', '3992', '4005', '4008', '4022', '4034', '4036', '4049', '4055', '4058', '4059', '4088', '4094', '4103', '4111', '4133', '4134', '4145', '4155', '4168', '4173', '418', '4182', '4203', '4215', '4225', '4235', '4247', '4254', '4266', '4272', '4278', '432', '4339', '4351', '4367', '4369', '438', '4386', '4393', '4410', '4427', '4428', '443', '4453', '4454', '4460', '4461', '4493', '45', '4509', '4556', '4563', '457', '4579', '4585', '459', '4606', '4608', '4617', '4645', '4669', '4676', '4686', '4741', '4747', '4749', '4754', '4760', '4765', '4767', '4776', '4779', '4794', '4807', '4812', '482', '4821', '4836', '4841', '4852', '4858', '4864', '4871', '4880', '4893', '4913', '492', '4976', '4988', '5039', '5053', '5062', '5072', '5087', '5090', '5101', '5114', '5128', '5142', '5146', '5147', '5158', '5174', '5183', '5187', '52', '5252', '5274', '5280', '5301', '5311', '5321', '5347', '5351', '5353', '5359', '5362', '5369', '5370', '5390', '5397', '54', '5403', '5407', '5419', '5445', '5449', '5450', '5457', '547', '5478', '5486', '5491', '55', '5513', '5537', '5556', '5569', '557', '560', '5600', '5601', '5609', '5610', '5612', '5617', '5623', '5628', '5631', '5640', '5647', '5650', '5662', '5665', '568', '5709', '5716', '5746', '576', '5762', '5765', '5786', '5804', '5808', '5812', '5818', '5836', '5841', '5862', '5867', '587', '5870', '5888', '5910', '5927', '5944', '5945', '5954', '597', '5977', '5992', '6', '6013', '6019', '6033', '6035', '6041', '6050', '6058', '6071', '6077', '608', '6084', '6090', '6111', '6112', '6126', '6145', '6178', '6184', '620', '6201', '6227', '6229', '623', '6232', '6236', '6254', '6266', '6272', '628', '6283', '6303', '6306', '6324', '633', '6340', '6362', '6366', '6374', '6379', '638', '6416', '6419', '6426', '6429', '6435', '6443', '6472', '6517', '6533', '6566', '657', '6589', '6598', '6605', '6619', '6624', '6631', '6646', '6651', '6665', '6670', '6679', '6688', '6697', '6706', '6713', '6715', '6728', '6729', '674', '6755', '6765', '6775', '6781', '6792', '6833', '684', '6842', '6844', '6871', '6878', '6889', '689', '6902', '6909', '692', '6958', '6965', '6979', '6981', '6986', '6990', '6999', '7017', '7024', '7026', '7035', '705', '7053', '7065', '7066', '7077', '7081', '7090', '7103', '7121', '7136', '7158', '7165', '7169', '7194', '7197', '7217', '724', '7260', '7293', '7305', '7320', '7324', '7333', '7342', '7349', '7376', '7382', '74', '7407', '7410', '7412', '7429', '7434', '7448', '7464', '7470', '7488', '749', '750', '7500', '7501', '7503', '753', '755', '7582', '7611', '7614', '7615', '7634', '7638', '7653', '7655', '7673', '7688', '7689', '7696', '7702', '771', '7730', '7741', '7758', '7777', '7782', '78', '7802', '7803', '7805', '7814', '7831', '7840', '7842', '7866', '7885', '7886', '7888', '7901', '7903', '7918', '792', '7940', '7981', '7982', '8018', '8028', '8056', '8072', '8081', '8093', '8094', '8112', '8113', '8130', '8137', '8145', '8152', '8156', '8158', '8164', '8170', '8180', '8188', '8189', '8190', '8194', '8202', '8222', '8227', '8228', '8263', '8281', '8290', '8303', '831', '8318', '8325', '8338', '8348', '8350', '838', '8389', '8401', '8416', '8417', '842', '8426', '8429', '8432', '8439', '8440', '8442', '8449', '8467', '848', '85', '8529', '8530', '8540', '8551', '8560', '8568', '8576', '8577', '8582', '8607', '8617', '8670', '8673', '8724', '8752', '8765', '8780', '8788', '8804', '8828', '8837', '8839', '8845', '8853', '8889', '892', '8928', '8945', '8948', '8949', '8952', '8974', '8998', '9001', '9002', '9003', '9023', '9058', '9098', '9102', '916', '9176', '9180', '9195', '9201', '9210', '9211', '9220', '9223', '9228', '9252', '9267', '9272', '9285', '9304', '9318', '9329', '9337', '9348', '9354', '9360', '9383', '9421', '9433', '944', '947', '9473', '9480', '9497', '9520', '9533', '9621', '9626', '9630', '9641', '9645', '9650', '9670', '9673', '9678', '97', '9706', '9724', '9732', '9733', '9752', '9754', '9755', '9759', '9776', '9788', '9801', '984', '9849', '9853', '9857', '9862', '9887', '9888', '9909', '9918', '9933', '9934', '9937', '9948', '996', '9978', '10033', '10036', '10044', '1007', '10109', '10127', '10177', '1020', '10206', '10242', '10256', '10260', '10291', '10300', '10307', '10348', '10359', '10373', '10385', '10417', '10424', '10440', '1050', '10525', '10528', '10541', '10561', '10576', '10590', '1060', '10606', '10610', '10651', '10652', '10665', '1067', '10681', '107', '109', '1107', '1146', '116', '1161', '1164', '1169', '1216', '1239', '1266', '1269', '1284', '1287', '1298', '1324', '136', '139', '1421', '1437', '1481', '1486', '150', '1545', '1548', '1552', '1574', '1597', '1605', '1610', '1625', '166', '1662', '1680', '1682', '1708', '1711', '1731', '1732', '1737', '1744', '1754', '1757', '1768', '1787', '1799', '1801', '1802', '181', '1812', '1837', '1848', '1852', '1961', '1964', '1967', '1976', '2017', '2029', '2042', '2054', '2086', '210', '2139', '215', '2187', '2199', '22', '2202', '2205', '222', '227', '2274', '2276', '2303', '2306', '2318', '234', '2358', '2372', '2375', '2393', '2405', '2406', '2408', '2413', '2437', '2438', '244', '2446', '2463', '2473', '2478', '2483', '2488', '2515', '2530', '2539', '2563', '2570', '2573', '261', '2610', '264', '2643', '2676', '2682', '2685', '27', '2704', '2735', '2774', '2777', '2780', '2793', '2800', '2815', '2817', '282', '2840', '2841', '2855', '2863', '2865', '2866', '2874', '2875', '2906', '2909', '2915', '2938', '2947', '296', '2968', '2972', '2982', '2992', '3038', '304', '3069', '3083', '3097', '3109', '3118', '3130', '3141', '3154', '3163', '3165', '3177', '3181', '3182', '3220', '3223', '3226', '3251', '3257', '3280', '3297', '3302', '3319', '3361', '340', '3416', '3419', '343', '3455', '3477', '3526', '3527', '3533', '3541', '3562', '3569', '3584', '3595', '361', '3613', '3616', '3630', '3677', '3679', '3685', '3686', '369', '3702', '3704', '3705', '3727', '3734', '374', '3772', '3790', '3810', '3816', '3835', '3842', '3866', '3884', '3983', '3997', '3999', '4009', '4026', '4039', '4040', '4057', '4079', '4099', '4106', '412', '4192', '4204', '4209', '4262', '4274', '4276', '4299', '4304', '4353', '4382', '4391', '4398', '4405', '441', '442', '4432', '4437', '4445', '4501', '4513', '4515', '4545', '4551', '4599', '4630', '4652', '4664', '4695', '471', '4743', '4788', '4789', '4857', '4873', '4888', '489', '4907', '4918', '4934', '4938', '4940', '4951', '4985', '5063', '5066', '5067', '5071', '5084', '510', '5118', '5151', '5160', '5169', '5188', '5192', '5204', '5236', '5239', '5251', '5255', '527', '5314', '5350', '5366', '538', '5385', '5409', '5421', '5433', '5440', '5459', '5480', '5490', '5496', '550', '5503', '5507', '5509', '5535', '555', '5579', '5613', '563', '5630', '565', '5676', '5725', '5739', '5751', '5759', '5785', '5791', '5793', '5806', '5822', '5860', '5924', '5958', '5991', '6023', '6066', '6080', '6143', '616', '6167', '6187', '6250', '6293', '631', '6329', '6345', '6348', '6349', '636', '6425', '643', '6444', '6469', '6484', '658', '6635', '665', '6684', '6730', '6744', '6773', '6774', '6804', '6814', '6851', '6882', '6913', '6918', '6923', '693', '6941', '6959', '6964', '7006', '7022', '7041', '7187', '7192', '7212', '7218', '7221', '7279', '7285', '7295', '7299', '7300', '7301', '7309', '7331', '7378', '7408', '7420', '7421', '7432', '7433', '7447', '7459', '747', '7487', '7537', '7609', '7613', '7619', '7624', '768', '7684', '7692', '7694', '7703', '7728', '7734', '7735', '7750', '7752', '7763', '7798', '7806', '7818', '785', '7871', '789', '7906', '7973', '7977', '7995', '8015', '802', '8103', '814', '8144', '8187', '8209', '8229', '8237', '8260', '8265', '8268', '827', '8278', '83', '8319', '8322', '8359', '839', '8407', '8410', '8457', '8462', '8478', '8479', '8486', '8488', '8489', '8509', '8519', '8534', '8537', '8557', '8563', '8585', '8597', '8603', '861', '8626', '8631', '8644', '8656', '8682', '8690', '8692', '8726', '8746', '8751', '8758', '8766', '8776', '8782', '8784', '8790', '8792', '88', '8807', '883', '8833', '8880', '8906', '891', '8910', '8917', '8970', '901', '9044', '9075', '9096', '9104', '9116', '9153', '9154', '9169', '9189', '92', '9207', '9218', '9237', '925', '927', '930', '9311', '9325', '9359', '9366', '9372', '9410', '9441', '9445', '9459', '9487', '9489', '9546', '955', '9561', '9584', '9585', '9620', '9644', '9647', '9692', '9708', '9711', '9716', '9720', '9735', '9741', '9749', '9773', '9818', '9832', '987', '9921', '9929', '9947', '9957', '9966'], 'validation': ['10074', '10155', '10277', '10292', '1034', '10397', '10403', '10435', '10456', '1047', '10480', '10484', '10502', '10507', '10569', '1057', '10573', '10582', '10694', '10714', '1072', '119', '1241', '1300', '1310', '1315', '1331', '1355', '1375', '1383', '1410', '1457', '1603', '1633', '1653', '1666', '1793', '180', '1814', '1847', '1850', '1878', '1947', '1995', '2037', '2052', '2074', '209', '2137', '217', '2208', '2235', '2262', '2313', '2315', '2364', '239', '2514', '2516', '2558', '2623', '2631', '2656', '2791', '2797', '2896', '290', '2910', '2916', '2957', '300', '3022', '3031', '3034', '3116', '3131', '3149', '3151', '3206', '3207', '3240', '3244', '3261', '3275', '3365', '3399', '3422', '3441', '3443', '3530', '3575', '3581', '3637', '368', '3719', '3801', '3871', '3918', '3920', '3993', '403', '4042', '4050', '408', '4142', '4189', '4211', '4213', '425', '4263', '4269', '4280', '4288', '4295', '4298', '4333', '4577', '4593', '4601', '4602', '4625', '4772', '4811', '4831', '4839', '4885', '4894', '4903', '4914', '4981', '5002', '5034', '504', '5157', '5162', '5171', '5198', '5220', '5229', '5234', '5279', '5455', '5541', '5564', '5595', '564', '5731', '5745', '5779', '5820', '5848', '5874', '588', '589', '5955', '5959', '6016', '6148', '6159', '6185', '6206', '6213', '6257', '6328', '6387', '6395', '6433', '6446', '6452', '6496', '6531', '6601', '6636', '6662', '6745', '676', '685', '6853', '6947', '695', '6966', '70', '701', '7141', '7160', '7178', '7198', '7484', '7517', '7531', '7563', '7648', '7652', '7669', '7716', '7749', '7792', '7828', '7867', '7904', '7915', '7924', '7959', '8085', '8090', '8198', '836', '8364', '8483', '8521', '8622', '8675', '868', '8699', '8813', '8892', '8907', '8932', '8977', '8996', '9043', '9113', '9141', '9165', '9168', '9313', '9387', '9448', '9450', '9498', '9562', '9582', '9586', '9658', '9661', '9676', '9728', '9758', '9766', '9770', '9783', '10010', '10112', '10157', '10192', '10212', '10223', '10303', '10360', '10368', '10413', '10575', '10729', '1119', '1149', '1154', '1156', '1283', '1329', '1372', '1415', '1433', '148', '1538', '167', '17', '1789', '1988', '1990', '1999', '201', '2092', '2121', '2213', '2289', '2360', '2439', '254', '2575', '2604', '2611', '2663', '2695', '2888', '2893', '2925', '2944', '2948', '2960', '3095', '3193', '3215', '3269', '336', '3607', '3751', '3765', '394', '402', '4023', '4038', '4152', '4199', '4219', '4318', '4319', '4385', '44', '4514', '4629', '4667', '4758', '4899', '4905', '4909', '4926', '4963', '51', '5108', '522', '5260', '5427', '5434', '5436', '5511', '5598', '5611', '5648', '5672', '5755', '5974', '6273', '6353', '6385', '6516', '6554', '6653', '6660', '6809', '6843', '6859', '7012', '7060', '7068', '7117', '7257', '7269', '7273', '7310', '7377', '7499', '7529', '757', '7651', '7708', '7733', '7744', '7788', '8027', '8102', '8133', '822', '8221', '8337', '8382', '8413', '8453', '8609', '8625', '8736', '8823', '886', '8926', '8930', '8958', '8972', '8999', '9004', '9032', '9072', '9111', '9128', '9157', '9234', '9269', '9341', '9379', '9395', '9490', '9515', '9531', '9577', '9696', '9723', '9789', '9810', '9837', '9893', '9920', '9974'], 'test': ['10011', '10058', '10147', '10175', '10226', '1027', '10273', '10334', '1040', '1052', '10570', '1061', '10621', '1076', '1079', '1181', '1182', '1264', '1323', '1439', '1501', '1656', '1718', '1729', '1735', '174', '1810', '1928', '199', '2002', '2234', '2353', '2354', '2477', '2699', '2829', '2924', '3020', '310', '3152', '3255', '332', '3565', '4015', '4054', '424', '4425', '4516', '4539', '458', '4586', '4594', '4651', '4910', '5004', '5250', '543', '5431', '5542', '5658', '5670', '5689', '5724', '5734', '5783', '582', '5947', '5993', '6124', '6291', '634', '6344', '6346', '6466', '6575', '6671', '6756', '6766', '68', '7002', '7004', '7174', '7238', '7255', '7306', '7480', '7516', '7656', '7663', '7718', '7843', '7893', '7947', '8105', '8109', '8142', '8147', '8256', '8366', '8500', '8511', '8541', '8734', '8757', '8868', '8950', '902', '9071', '9205', '9320', '9403', '9420', '9476', '952', '9543', '9572', '959', '9709', '976', '9844', '9899', '1003', '10095', '10190', '10286', '10407', '10451', '10521', '10572', '10664', '123', '1403', '1443', '1506', '164', '1696', '1845', '1992', '2060', '23', '2325', '2396', '2465', '2710', '3098', '3253', '3270', '3278', '3285', '3622', '3752', '3917', '3919', '4137', '414', '4200', '4214', '4268', '4700', '4756', '4770', '5015', '5144', '5256', '5432', '544', '5454', '5591', '5918', '6082', '6267', '6297', '6308', '6749', '6802', '6899', '6901', '6930', '7086', '7135', '7428', '7430', '7443', '7572', '7808', '781', '8060', '8469', '8470', '8495', '8504', '8613', '8694', '8703', '8708', '8838', '9056', '9427', '9922', '9968', '9994']}
labels = {'8622': 1, '1072': 1, '10456': 1, '2063': 1, '9448': 1, '7310': 0, '3098': 0, '1173': 1, '771': 1, '5647': 1, '2213': 0, '4871': 1, '10175': 1, '10502': 1, '68': 1, '7117': 0, '8416': 1, '6804': 0, '7802': 1, '842': 1, '5397': 1, '5725': 0, '6941': 0, '3053': 1, '891': 0, '4333': 1, '2234': 1, '3223': 0, '92': 0, '414': 0, '1662': 0, '1768': 0, '9459': 0, '5220': 1, '174': 1, '2641': 1, '9096': 0, '1868': 1, '7421': 0, '7377': 0, '7217': 1, '9313': 1, '1094': 1, '7609': 0, '538': 0, '3097': 0, '838': 1, '6472': 1, '9366': 0, '9348': 1, '5279': 1, '9670': 1, '8366': 1, '5630': 0, '3227': 1, '8734': 1, '3677': 0, '10590': 0, '4509': 1, '9645': 1, '7703': 0, '10192': 0, '8265': 0, '6206': 1, '3151': 1, '6589': 1, '1874': 1, '4353': 0, '2304': 1, '10285': 1, '7728': 0, '9957': 0, '6728': 1, '9421': 1, '5449': 1, '8560': 1, '3920': 1, '5945': 1, '6082': 0, '2478': 0, '7788': 0, '3297': 0, '6232': 1, '2289': 0, '3637': 1, '8974': 1, '2982': 0, '4667': 0, '9427': 0, '2417': 1, '6981': 1, '1606': 1, '6374': 1, '2968': 0, '6756': 1, '418': 1, '4669': 1, '7918': 1, '9267': 1, '827': 0, '4903': 1, '2957': 1, '5662': 1, '6353': 0, '8094': 1, '9379': 0, '2372': 0, '5160': 0, '1850': 1, '261': 0, '4247': 1, '2185': 1, '8426': 1, '5628': 1, '2429': 1, '4219': 0, '6050': 1, '7808': 0, '7376': 1, '1825': 1, '4556': 1, '5631': 1, '10368': 0, '6443': 1, '6844': 1, '2701': 1, '1480': 1, '5171': 1, '1980': 1, '5252': 1, '2353': 1, '10032': 1, '471': 0, '8780': 1, '9180': 1, '4288': 1, '7501': 1, '8932': 1, '3253': 0, '10407': 0, '4215': 1, '8576': 1, '2558': 1, '3507': 1, '8673': 1, '3759': 1, '916': 1, '1575': 1, '10033': 0, '5676': 0, '1610': 0, '7480': 1, '8853': 1, '9157': 0, '5128': 1, '3686': 0, '9141': 1, '1481': 0, '3997': 0, '6395': 1, '8703': 0, '1181': 1, '2066': 1, '7537': 0, '8752': 1, '5716': 1, '9741': 0, '1891': 1, '5192': 0, '9111': 0, '4545': 0, '9716': 0, '3234': 1, '8757': 1, '2496': 1, '3303': 1, '5804': 1, '9893': 0, '8469': 0, '2780': 0, '1847': 1, '9937': 1, '7651': 0, '10403': 1, '3046': 1, '6688': 1, '4385': 0, '6257': 1, '10664': 0, '1202': 1, '6670': 1, '10480': 1, '7459': 0, '8015': 0, '657': 1, '5511': 0, '5959': 1, '8290': 1, '4951': 0, '5806': 0, '10651': 0, '8260': 0, '9228': 1, '9490': 0, '6': 1, '6071': 1, '10157': 0, '1415': 0, '6340': 1, '8782': 0, '4155': 1, '10360': 0, '6965': 1, '9220': 1, '3679': 0, '128': 1, '2262': 1, '5888': 1, '201': 0, '5779': 1, '6328': 1, '3575': 1, '3375': 1, '1164': 0, '2761': 1, '7750': 0, '9818': 0, '227': 0, '3616': 0, '5162': 1, '7487': 0, '2473': 0, '215': 0, '5910': 1, '6019': 1, '2548': 1, '8338': 1, '2685': 0, '6964': 0, '8751': 0, '1595': 1, '9735': 0, '3775': 1, '1952': 1, '5537': 1, '5174': 1, '3569': 0, '5507': 0, '3983': 0, '1148': 1, '2181': 1, '3925': 1, '6781': 1, '701': 1, '10126': 1, '6035': 1, '4199': 0, '8568': 1, '9072': 0, '10595': 1, '9585': 0, '6706': 1, '8112': 1, '8675': 1, '492': 1, '2704': 0, '441': 0, '3790': 0, '5709': 1, '6745': 1, '8582': 1, '10169': 1, '7429': 1, '9320': 1, '2874': 0, '9153': 0, '3660': 1, '9104': 0, '643': 0, '9165': 1, '268': 1, '2797': 1, '831': 1, '9473': 1, '9706': 1, '2315': 1, '576': 1, '9252': 1, '4410': 1, '3189': 1, '8209': 0, '2896': 1, '4235': 1, '3826': 1, '1766': 1, '4382': 0, '2802': 1, '3280': 0, '6266': 1, '4039': 0, '6853': 1, '4134': 1, '3450': 1, '7924': 1, '6729': 1, '9325': 0, '74': 1, '4501': 0, '1058': 1, '1700': 1, '2408': 0, '4789': 0, '9728': 1, '8509': 0, '7430': 0, '5359': 1, '9237': 0, '5860': 0, '432': 1, '6023': 0, '9480': 1, '369': 0, '3835': 0, '5280': 1, '9102': 1, '2010': 1, '4617': 1, '3056': 1, '944': 1, '9360': 1, '7947': 1, '4173': 1, '5321': 1, '1641': 1, '3862': 1, '9974': 0, '5535': 0, '1128': 1, '6080': 0, '4298': 1, '3751': 0, '7792': 1, '9586': 1, '8519': 0, '1597': 0, '8056': 1, '7828': 1, '10064': 1, '4651': 1, '9789': 0, '2393': 0, '3841': 1, '7407': 1, '2276': 0, '3622': 0, '5188': 0, '1799': 0, '5034': 1, '2418': 1, '150': 0, '8228': 1, '7959': 1, '7684': 0, '3090': 1, '4103': 1, '6349': 0, '5672': 0, '3537': 1, '749': 1, '504': 1, '3705': 0, '5311': 1, '403': 1, '5612': 1, '6387': 1, '3801': 1, '4981': 1, '305': 1, '9154': 0, '199': 1, '3028': 1, '300': 1, '8682': 0, '6254': 1, '2144': 1, '984': 1, '3765': 0, '1995': 1, '1467': 1, '27': 0, '8478': 0, '17': 0, '8018': 1, '10291': 0, '8828': 1, '8839': 1, '9994': 0, '2774': 0, '2676': 0, '10239': 1, '883': 0, '9001': 1, '9043': 1, '1945': 1, '6425': 0, '1383': 1, '3526': 0, '9195': 1, '8766': 0, '4254': 1, '868': 1, '7002': 1, '2623': 1, '5955': 1, '9844': 1, '2438': 0, '2060': 0, '1107': 0, '5198': 1, '7782': 1, '9766': 1, '2610': 0, '7904': 1, '52': 1, '5762': 1, '7843': 1, '1249': 1, '10221': 1, '555': 0, '10307': 0, '6236': 1, '9285': 1, '2511': 1, '7842': 1, '8950': 1, '7831': 1, '6636': 1, '4088': 1, '1583': 1, '6227': 1, '1788': 1, '4367': 1, '9207': 0, '4369': 1, '2947': 0, '7663': 1, '1331': 1, '8109': 1, '1633': 1, '4318': 0, '4111': 1, '4055': 1, '5746': 1, '1335': 1, '6575': 1, '1471': 1, '8724': 1, '2677': 1, '55': 1, '8103': 0, '6201': 1, '9205': 1, '848': 1, '8189': 1, '1634': 1, '78': 1, '684': 1, '6344': 1, '5731': 1, '5053': 1, '10074': 1, '3564': 1, '6909': 1, '4664': 0, '7619': 0, '6802': 0, '6990': 1, '9783': 1, '5759': 0, '10418': 1, '4005': 1, '10273': 1, '4885': 1, '781': 0, '6730': 0, '8442': 1, '5407': 1, '634': 1, '9071': 1, '337': 1, '3752': 0, '8541': 1, '8486': 0, '7499': 0, '8626': 0, '4586': 1, '7982': 1, '8348': 1, '7488': 1, '4513': 0, '8511': 1, '10616': 1, '10531': 1, '3220': 0, '9441': 0, '527': 0, '927': 0, '2235': 1, '3674': 1, '7798': 0, '3884': 0, '9755': 1, '7309': 0, '1506': 0, '3685': 0, '10471': 1, '5390': 1, '3157': 1, '4841': 1, '7066': 1, '5751': 0, '6058': 1, '10223': 0, '1284': 0, '1928': 1, '5610': 1, '148': 0, '1999': 0, '4427': 1, '9857': 1, '2205': 0, '3999': 0, '2706': 1, '1049': 1, '8180': 1, '2325': 0, '4858': 1, '2893': 0, '8699': 1, '4034': 1, '7741': 1, '9004': 0, '7977': 0, '3235': 1, '7035': 1, '2354': 1, '2756': 1, '3919': 0, '442': 0, '368': 1, '4213': 1, '10303': 0, '3069': 0, '7777': 1, '9098': 1, '2682': 0, '5564': 1, '9383': 1, '3772': 0, '2364': 1, '3130': 0, '947': 1, '1234': 1, '6744': 0, '4299': 0, '2993': 1, '7840': 1, '1810': 1, '8930': 0, '10424': 0, '7255': 1, '3455': 0, '768': 0, '139': 0, '10413': 0, '7447': 0, '2934': 1, '5958': 0, '6013': 1, '2817': 0, '4263': 1, '4460': 1, '166': 0, '6345': 0, '9933': 1, '2017': 0, '3165': 0, '7582': 1, '6416': 1, '589': 1, '9433': 1, '3091': 1, '4563': 1, '4686': 1, '109': 0, '7432': 0, '2394': 1, '8198': 1, '8028': 1, '4453': 1, '8060': 0, '1355': 1, '7464': 1, '10575': 0, '8410': 0, '2303': 0, '1323': 1, '8845': 1, '5434': 0, '8906': 0, '3418': 1, '234': 0, '9650': 1, '8237': 0, '3031': 1, '1248': 1, '1103': 1, '1060': 0, '5440': 0, '7103': 1, '638': 1, '412': 0, '1878': 1, '9420': 1, '7692': 0, '7871': 0, '5992': 1, '4393': 1, '1457': 1, '8784': 0, '3719': 1, '9341': 0, '2916': 1, '7688': 1, '6809': 0, '1744': 0, '1399': 1, '3541': 0, '5314': 0, '9966': 0, '3034': 1, '3137': 1, '8585': 0, '10109': 0, '9673': 1, '2875': 0, '2413': 0, '2074': 1, '5480': 0, '1519': 1, '6077': 1, '9387': 1, '1187': 1, '4057': 0, '9329': 1, '9658': 1, '6566': 1, '2815': 0, '1816': 1, '1605': 0, '8746': 0, '9732': 1, '9543': 1, '8027': 0, '7733': 0, '4602': 1, '7285': 0, '7192': 0, '97': 1, '8256': 1, '5954': 1, '2360': 0, '2269': 1, '836': 1, '6143': 0, '1011': 1, '2229': 1, '674': 1, '10714': 1, '119': 1, '6653': 0, '4268': 0, '6554': 0, '10681': 0, '10576': 0, '3084': 1, '7434': 1, '2855': 0, '290': 1, '5118': 0, '3993': 1, '9562': 1, '1216': 0, '597': 1, '1256': 1, '7563': 1, '9849': 1, '5385': 0, '10338': 1, '9497': 1, '3842': 0, '2865': 0, '9788': 1, '8838': 0, '7995': 0, '123': 0, '1020': 0, '2274': 0, '10582': 1, '10657': 1, '7410': 1, '2086': 0, '1838': 1, '2516': 1, '1790': 1, '2052': 1, '8113': 1, '4629': 0, '9754': 1, '2515': 0, '3207': 1, '2915': 0, '1545': 0, '9720': 0, '676': 1, '3201': 1, '5063': 0, '8521': 1, '5147': 1, '8350': 1, '4760': 1, '3727': 0, '4042': 1, '7818': 0, '254': 0, '7412': 1, '7758': 1, '6713': 1, '489': 0, '5421': 0, '3275': 1, '7378': 0, '4579': 1, '7420': 0, '209': 1, '2439': 0, '2850': 1, '3251': 0, '9515': 0, '2459': 1, '4278': 1, '4676': 1, '10593': 1, '6433': 1, '6859': 0, '8407': 0, '1435': 1, '10577': 1, '7260': 1, '7160': 1, '4772': 1, '8081': 1, '747': 0, '1560': 1, '5087': 1, '8137': 1, '10242': 0, '10010': 0, '2793': 0, '10383': 1, '6605': 1, '4009': 0, '6429': 1, '1553': 1, '4209': 0, '2488': 0, '6033': 1, '10665': 0, '2643': 0, '1161': 0, '2514': 1, '1149': 0, '861': 0, '1027': 1, '1146': 0, '1079': 1, '2132': 1, '5250': 1, '4428': 1, '1625': 0, '5455': 1, '2452': 1, '2932': 1, '6184': 1, '7484': 1, '9621': 1, '8417': 1, '1709': 1, '8202': 1, '296': 0, '1439': 1, '5351': 1, '7408': 0, '1310': 1, '4280': 1, '6435': 1, '1372': 0, '7655': 1, '4036': 1, '9395': 0, '4211': 1, '2178': 1, '9210': 1, '5101': 1, '4272': 1, '3109': 0, '2631': 1, '6979': 1, '4026': 0, '8910': 0, '5791': 0, '4493': 1, '6187': 0, '5867': 1, '3141': 0, '9572': 1, '4145': 1, '1976': 0, '10606': 0, '5450': 1, '3174': 1, '7448': 1, '10072': 1, '4304': 0, '3970': 1, '3704': 0, '1195': 1, '7752': 0, '264': 0, '8833': 0, '3118': 0, '336': 0, '8813': 1, '9749': 0, '4593': 1, '2347': 1, '4630': 0, '2765': 1, '3261': 1, '9947': 0, '6871': 1, '2139': 0, '5436': 0, '1154': 0, '5144': 0, '1189': 1, '10364': 1, '5542': 1, '7638': 1, '4015': 1, '2674': 1, '6947': 1, '3038': 0, '3788': 1, '10573': 1, '3419': 0, '6324': 1, '8644': 0, '2110': 1, '7324': 1, '10011': 1, '2587': 1, '3562': 0, '5366': 0, '2133': 1, '9168': 1, '7613': 0, '1433': 0, '5015': 0, '6362': 1, '2841': 0, '7004': 1, '210': 0, '4432': 0, '8880': 0, '9626': 1, '2829': 1, '4880': 1, '6167': 0, '6843': 0, '1814': 1, '5251': 0, '1099': 1, '2563': 0, '8928': 1, '3552': 1, '7669': 1, '8457': 0, '4106': 0, '2054': 0, '5234': 1, '8917': 0, '1375': 1, '2130': 1, '1269': 0, '665': 0, '1807': 1, '44': 0, '4888': 0, '2907': 1, '10397': 1, '2290': 1, '5658': 1, '7238': 1, '2384': 1, '6959': 0, '6715': 1, '6185': 1, '7135': 0, '7531': 1, '1653': 1, '608': 1, '3188': 1, '1065': 1, '9920': 0, '22': 0, '10569': 1, '7305': 1, '183': 1, '2199': 0, '2463': 0, '5874': 1, '1067': 0, '6765': 1, '3422': 1, '4831': 1, '2699': 1, '1892': 1, '792': 1, '3729': 1, '1737': 0, '4225': 1, '1964': 0, '3918': 1, '198': 1, '394': 0, '5755': 0, '4606': 1, '4893': 1, '10095': 0, '9189': 0, '7500': 1, '9918': 1, '1989': 1, '10288': 1, '3274': 1, '9002': 1, '4938': 0, '3617': 1, '4058': 1, '5419': 1, '3523': 1, '7814': 1, '8977': 1, '10525': 0, '7342': 1, '952': 1, '6966': 1, '8170': 1, '8222': 1, '1357': 1, '425': 1, '10650': 1, '5944': 1, '7763': 0, '1732': 0, '3246': 1, '1639': 1, '8229': 0, '9978': 1, '2574': 1, '2530': 0, '9201': 1, '2092': 0, '3607': 0, '5600': 1, '4601': 1, '8617': 1, '5445': 1, '5370': 1, '10516': 1, '10348': 0, '1283': 0, '7136': 1, '8949': 1, '7026': 1, '3734': 0, '217': 1, '3216': 1, '7194': 1, '3434': 1, '3627': 1, '8495': 0, '83': 0, '1504': 1, '1621': 1, '2335': 1, '6902': 1, '7624': 0, '3399': 1, '5977': 1, '375': 1, '5362': 1, '6283': 1, '8133': 0, '10334': 1, '7333': 1, '3181': 0, '7981': 1, '6684': 0, '2924': 1, '3702': 0, '9948': 1, '3244': 1, '244': 0, '9837': 0, '3020': 1, '10282': 1, '9403': 1, '1048': 1, '2791': 1, '8557': 0, '6124': 1, '457': 1, '5974': 0, '2157': 1, '8551': 1, '6366': 1, '1809': 1, '2088': 1, '3083': 0, '5229': 1, '1729': 1, '4741': 1, '3193': 0, '2124': 1, '5490': 0, '9773': 0, '10521': 0, '2604': 0, '5067': 0, '6814': 0, '1431': 1, '352': 1, '1002': 1, '4976': 1, '3226': 0, '2037': 1, '5609': 1, '4425': 1, '9644': 0, '2232': 1, '8194': 1, '7888': 1, '8142': 1, '3182': 0, '6999': 1, '3560': 1, '4059': 1, '10256': 0, '7702': 1, '8807': 0, '8432': 1, '1961': 0, '1500': 1, '7749': 1, '10164': 1, '136': 0, '6145': 1, '1667': 1, '10177': 0, '8439': 1, '8790': 0, '3301': 1, '340': 0, '3177': 0, '10248': 1, '6517': 1, '7805': 1, '7689': 1, '7086': 0, '9888': 1, '3565': 1, '6229': 1, '8868': 1, '1156': 0, '4807': 1, '7017': 1, '1731': 0, '692': 1, '5491': 1, '2925': 0, '3255': 1, '2945': 1, '785': 0, '8303': 1, '9450': 1, '4539': 1, '10206': 0, '3395': 1, '6379': 1, '6842': 1, '364': 1, '3530': 1, '7803': 1, '1241': 1, '2117': 1, '2960': 0, '6452': 1, '3971': 1, '1940': 1, '2973': 1, '955': 0, '4914': 1, '4926': 0, '8692': 0, '7730': 1, '3443': 1, '6531': 1, '5793': 0, '6646': 1, '3327': 1, '8072': 1, '8765': 1, '6213': 1, '2710': 0, '10451': 0, '10134': 1, '6303': 1, '976': 1, '10388': 1, '2002': 1, '9862': 1, '6986': 1, '4899': 0, '1802': 0, '458': 1, '2311': 1, '1708': 0, '3595': 0, '9968': 0, '3022': 1, '4905': 0, '10429': 1, '4910': 1, '9921': 0, '1363': 1, '2375': 0, '7572': 0, '3917': 0, '10440': 0, '1231': 1, '361': 0, '5260': 0, '5623': 1, '1153': 1, '6385': 0, '587': 1, '5072': 1, '3547': 1, '7006': 0, '1682': 0, '8105': 1, '3416': 0, '5004': 1, '5002': 1, '4821': 1, '4794': 1, '1696': 0, '8792': 0, '5601': 1, '8945': 1, '114': 1, '10529': 1, '5745': 1, '8823': 0, '930': 0, '4054': 1, '1674': 1, '10277': 1, '3768': 1, '1812': 0, '8788': 1, '5613': 0, '239': 1, '1538': 0, '8364': 1, '7716': 1, '9832': 0, '2425': 1, '7221': 0, '695': 1, '1162': 1, '9711': 0, '5062': 1, '1061': 1, '6792': 1, '2922': 1, '5142': 1, '7433': 0, '5611': 0, '5689': 1, '2221': 1, '3285': 0, '9023': 1, '8382': 0, '616': 0, '7615': 1, '3206': 1, '6273': 0, '120': 1, '8563': 0, '6671': 1, '7734': 0, '4203': 1, '6041': 1, '3154': 0, '6516': 0, '8996': 1, '443': 1, '10528': 0, '5039': 1, '5187': 1, '5786': 1, '6899': 0, '9709': 1, '685': 1, '1852': 0, '8998': 1, '6918': 0, '3810': 0, '1300': 1, '9922': 0, '4985': 0, '5812': 1, '2029': 0, '2573': 0, '424': 1, '7197': 1, '4189': 1, '5591': 0, '1958': 1, '8147': 1, '31': 1, '2371': 1, '10694': 1, '5486': 1, '9218': 0, '222': 0, '3890': 1, '4873': 0, '4142': 1, '5503': 0, '10572': 0, '10417': 0, '10044': 0, '2249': 1, '5066': 0, '2187': 0, '2106': 1, '6755': 1, '9577': 0, '7867': 1, '45': 1, '2079': 1, '10112': 0, '7915': 1, '8462': 0, '822': 0, '8656': 0, '5513': 1, '4864': 1, '9533': 1, '1943': 1, '8577': 1, '1735': 1, '6773': 0, '8144': 0, '1548': 0, '10435': 1, '5114': 1, '3302': 0, '8708': 0, '10389': 1, '750': 1, '6346': 1, '5169': 0, '5146': 1, '1052': 1, '8999': 0, '51': 0, '5595': 1, '1364': 1, '6923': 0, '8690': 0, '2358': 0, '7349': 1, '8625': 0, '1111': 1, '5841': 1, '1573': 1, '214': 1, '9770': 1, '54': 1, '5369': 1, '2477': 1, '1417': 1, '3579': 1, '10707': 1, '4779': 1, '2972': 0, '10522': 1, '959': 1, '7503': 1, '10620': 1, '204': 1, '5724': 1, '4133': 1, '2437': 0, '3581': 1, '9498': 1, '7158': 1, '8613': 0, '5108': 0, '3649': 1, '8102': 0, '2039': 1, '2908': 1, '8483': 1, '191': 1, '560': 1, '2272': 1, '5734': 1, '7866': 1, '4319': 0, '6619': 1, '5256': 0, '3448': 1, '2036': 1, '2638': 1, '2469': 1, '2735': 0, '1239': 0, '658': 0, '7696': 1, '8188': 1, '4137': 0, '2632': 1, '5818': 1, '5836': 1, '9003': 1, '7973': 0, '2011': 1, '582': 1, '7293': 1, '9531': 0, '10653': 1, '343': 0, '8467': 1, '2948': 0, '6631': 1, '9176': 1, '4445': 0, '4551': 0, '5459': 0, '4200': 0, '2137': 1, '6419': 1, '7903': 1, '7090': 1, '543': 1, '2550': 1, '1175': 1, '9372': 0, '9810': 0, '1298': 0, '9759': 1, '6624': 1, '7295': 0, '4038': 0, '7382': 1, '3819': 1, '3758': 1, '8389': 1, '9354': 1, '3533': 0, '2607': 1, '3152': 1, '1718': 1, '10359': 0, '1967': 0, '9708': 0, '3236': 1, '8952': 1, '6291': 1, '4754': 1, '2208': 1, '88': 0, '7708': 0, '6293': 0, '7279': 0, '2539': 0, '568': 1, '1929': 1, '9234': 0, '2695': 0, '3215': 0, '6148': 1, '4214': 0, '8130': 1, '1865': 1, '6878': 1, '1912': 1, '6496': 1, '9211': 1, '5617': 1, '4700': 0, '892': 1, '4050': 1, '4788': 0, '987': 0, '10351': 1, '4339': 1, '5665': 1, '1410': 1, '4812': 1, '10583': 1, '4023': 0, '6272': 1, '6679': 1, '3319': 0, '10541': 0, '755': 1, '9318': 1, '5569': 1, '6111': 1, '10484': 1, '10036': 0, '2944': 0, '8470': 0, '7301': 0, '2396': 0, '1063': 1, '10260': 0, '996': 1, '1142': 1, '9692': 0, '1598': 1, '3728': 1, '3116': 1, '5239': 0, '3441': 1, '8529': 1, '5090': 1, '2992': 0, '1119': 0, '1894': 1, '4625': 1, '10127': 0, '9661': 1, '5650': 1, '1324': 0, '10341': 1, '8453': 0, '7718': 1, '3163': 0, '7141': 1, '3113': 1, '1848': 0, '8413': 0, '1486': 0, '10254': 1, '7165': 1, '7653': 1, '9620': 0, '7060': 0, '4934': 0, '2446': 0, '7077': 1, '588': 1, '3613': 0, '10131': 1, '4608': 1, '8631': 0, '4765': 1, '4857': 0, '4963': 0, '8281': 1, '633': 1, '482': 1, '2575': 0, '5509': 0, '4577': 1, '5739': 0, '3876': 1, '7174': 1, '8726': 0, '10261': 1, '2483': 0, '6178': 1, '7269': 0, '459': 1, '4295': 1, '9723': 0, '8489': 0, '5274': 1, '7041': 0, '6329': 0, '9223': 1, '7906': 0, '3269': 0, '1574': 0, '402': 0, '8530': 1, '4599': 0, '5347': 1, '8359': 0, '1034': 1, '628': 1, '6444': 0, '9647': 0, '8736': 0, '9445': 0, '9678': 1, '180': 1, '4743': 0, '4747': 1, '2313': 1, '8972': 0, '9476': 1, '1219': 1, '8221': 0, '724': 1, '7300': 0, '408': 1, '9853': 1, '3361': 0, '164': 0, '4099': 0, '9929': 0, '2656': 1, '3816': 0, '10190': 0, '5496': 0, '10292': 1, '3527': 0, '4645': 1, '9584': 0, '9304': 1, '4262': 0, '304': 0, '3742': 1, '9487': 0, '1050': 0, '9272': 1, '8758': 0, '5183': 1, '9724': 1, '9887': 1, '5670': 1, '3699': 1, '5071': 0, '6775': 1, '9934': 1, '7516': 1, '9169': 0, '8804': 1, '789': 0, '6913': 0, '9116': 0, '2406': 0, '6958': 1, '3558': 1, '5862': 1, '522': 0, '10507': 1, '1793': 1, '4266': 1, '9113': 1, '1992': 0, '9776': 1, '4594': 1, '5785': 0, '5301': 1, '10610': 0, '1008': 1, '6749': 0, '8156': 1, '1990': 0, '3376': 1, '4386': 1, '10729': 0, '7212': 0, '4839': 1, '1047': 1, '4405': 0, '4918': 0, '6901': 0, '9909': 1, '7634': 1, '9489': 0, '1947': 1, '3978': 1, '8500': 1, '10571': 1, '8190': 1, '8145': 1, '9758': 1, '9752': 1, '6665': 1, '9269': 0, '8776': 0, '2121': 0, '3300': 1, '4907': 0, '2529': 1, '1329': 0, '10373': 0, '6766': 1, '6697': 1, '1443': 0, '9630': 1, '2777': 0, '4940': 0, '7611': 1, '4836': 1, '438': 1, '7198': 1, '1007': 0, '6601': 1, '3871': 1, '689': 1, '9733': 1, '8152': 1, '10621': 1, '8889': 1, '5151': 0, '7529': 0, '7517': 1, '3095': 0, '85': 1, '10570': 1, '3240': 1, '705': 1, '23': 0, '1552': 0, '1845': 0, '1437': 0, '1836': 1, '7273': 0, '9337': 1, '5648': 0, '7901': 1, '2651': 1, '1757': 0, '4514': 0, '8158': 1, '6930': 0, '901': 0, '631': 0, '10561': 0, '362': 1, '9410': 0, '8694': 0, '6851': 0, '2280': 1, '636': 0, '2888': 0, '7065': 1, '8440': 1, '7053': 1, '8537': 0, '1801': 0, '886': 0, '4351': 1, '3510': 1, '3386': 1, '6306': 1, '5255': 0, '7735': 0, '8609': 0, '2937': 1, '8449': 1, '3149': 1, '4437': 0, '1288': 1, '8322': 0, '7081': 1, '4398': 0, '7614': 1, '2306': 0, '6066': 0, '6090': 1, '7299': 0, '2800': 0, '4391': 0, '2906': 0, '7893': 1, '2910': 1, '1666': 1, '4516': 1, '3584': 0, '7885': 1, '167': 0, '2611': 0, '9546': 0, '4515': 0, '117': 1, '564': 1, '6112': 1, '1827': 1, '1115': 1, '5157': 1, '5783': 1, '1988': 0, '10226': 1, '9641': 1, '5403': 1, '9056': 0, '7443': 0, '10085': 1, '9561': 0, '4770': 0, '2938': 0, '2248': 1, '550': 0, '3278': 0, '4182': 1, '4811': 1, '2445': 1, '620': 1, '1287': 0, '1426': 1, '7673': 1, '271': 1, '4022': 1, '2173': 1, '3009': 1, '6662': 1, '3077': 1, '6774': 0, '2663': 0, '1612': 1, '4461': 1, '1603': 1, '1656': 1, '510': 0, '5870': 1, '565': 0, '5478': 1, '5433': 0, '623': 1, '6833': 1, '8597': 0, '9075': 0, '753': 1, '4454': 1, '1172': 1, '5822': 0, '4274': 0, '6484': 0, '263': 1, '6469': 0, '7940': 1, '4168': 1, '7648': 1, '7886': 1, '9899': 1, '4894': 1, '5541': 1, '5084': 0, '5350': 0, '10286': 0, '3490': 1, '4008': 1, '1659': 1, '2318': 0, '2259': 1, '8263': 1, '10276': 1, '6297': 0, '2996': 1, '8318': 1, '6426': 1, '2405': 0, '9696': 0, '3260': 1, '7470': 1, '10212': 0, '557': 1, '282': 0, '8607': 1, '1003': 0, '7012': 0, '8670': 1, '5409': 0, '7656': 1, '4152': 0, '5848': 1, '10155': 1, '7187': 0, '3108': 1, '8319': 0, '2840': 0, '8892': 1, '4749': 1, '5927': 1, '5579': 0, '7022': 0, '10225': 1, '7652': 1, '7694': 0, '8488': 0, '3270': 0, '4776': 1, '374': 0, '802': 0, '294': 1, '8603': 0, '8907': 1, '4913': 1, '7169': 1, '3477': 0, '8085': 1, '6651': 1, '9520': 1, '8429': 1, '4094': 1, '4192': 0, '5236': 0, '4040': 0, '9044': 0, '10147': 1, '10486': 1, '2570': 0, '8325': 1, '228': 1, '8278': 0, '3866': 0, '8164': 1, '2909': 0, '814': 0, '10652': 0, '693': 0, '6533': 1, '6159': 1, '5454': 0, '3732': 1, '1789': 0, '9128': 0, '8093': 1, '5640': 1, '4988': 1, '3858': 1, '4652': 0, '7744': 0, '6267': 0, '3992': 1, '925': 0, '1421': 0, '8534': 0, '7320': 1, '7806': 0, '3061': 1, '544': 0, '1076': 1, '4852': 1, '5918': 0, '757': 0, '6635': 0, '3717': 1, '4756': 0, '3365': 1, '6348': 0, '4695': 0, '8090': 1, '1057': 1, '9058': 1, '181': 0, '8958': 0, '4909': 0, '563': 0, '1490': 1, '7178': 1, '2203': 1, '1264': 1, '9582': 1, '1711': 0, '1169': 0, '6882': 0, '8504': 0, '2863': 0, '2355': 1, '1683': 1, '2866': 0, '1266': 0, '1068': 1, '5432': 0, '8401': 1, '10058': 1, '5598': 0, '5457': 1, '1680': 0, '2700': 1, '70': 1, '8187': 0, '3011': 1, '6889': 1, '7121': 1, '6598': 1, '8479': 0, '6126': 1, '1182': 1, '1944': 1, '1837': 0, '6466': 1, '6016': 1, '8926': 0, '6084': 1, '8540': 1, '5427': 0, '7218': 0, '3817': 1, '5353': 1, '8970': 0, '547': 1, '5808': 1, '1501': 1, '9311': 0, '7257': 0, '10591': 1, '3257': 0, '7428': 0, '1403': 0, '1754': 0, '902': 1, '6660': 0, '1787': 0, '5924': 0, '3131': 1, '8337': 0, '6446': 1, '6308': 0, '4269': 1, '4767': 1, '1242': 1, '2202': 0, '5947': 1, '4079': 0, '5556': 1, '8227': 1, '4585': 1, '107': 0, '6250': 0, '3630': 0, '2071': 1, '1040': 1, '10385': 0, '4758': 0, '4049': 1, '5204': 0, '9359': 0, '5765': 1, '4204': 0, '5431': 1, '8268': 0, '1660': 1, '8837': 1, '7331': 0, '2465': 0, '8948': 1, '332': 1, '2042': 0, '5993': 1, '5820': 1, '7024': 1, '5991': 0, '1315': 1, '9801': 1, '310': 1, '9032': 0, '4276': 0, '5158': 1, '2740': 1, '116': 0, '7306': 1, '7068': 0, '839': 0, '10300': 0, '9676': 1}

# Generators
training_generator = DataGenerator(partition['train'], labels, **params)
validation_generator = DataGenerator(partition['validation'], labels, **params)
test_generator = DataGenerator(partition['test'], labels, **params)

#____Number 0f Epochs_________
epochs = 2
#_____________________________


# --------------3D-VGG------------------------
model=get_model_3DVGG(shape = (256, 256, 256, 1))
# Train the model, doing validation at the end of each epoch
model.compile(
    loss="binary_crossentropy",
    optimizer='adam',
    metrics=["acc"],
)
log_dir = "/home/santosh_lab/shared/HugoM/hpc_fold/" + datetime.datetime.now().strftime("%Y%m%d-%H%M%S")

tensorboard_callback = tf.keras.callbacks.TensorBoard(log_dir=log_dir, histogram_freq=1)


print("starting vgg training")

history=model.fit(
    training_generator, 
    validation_data=validation_generator, 
    epochs=epochs,
    verbose=2, #progress bar
    callbacks=[tensorboard_callback],
    use_multiprocessing=True
)

print("training completed")

visualize_results(history)

fig, ax = plt.subplots(1, 2, figsize=(20, 3))
ax = ax.ravel()

for i, metric in enumerate(["acc", "loss"]):
    ax[i].plot(model.history.history[metric])
    ax[i].plot(model.history.history["val_" + metric])
    ax[i].set_xlabel("epochs")
    ax[i].set_ylabel(metric)
    ax[i].legend(["train", "val"])